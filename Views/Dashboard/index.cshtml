@{
    ViewData["Title"] = "Traffic Analytics Dashboard";
}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">Traffic Analytics Dashboard</h4>
    <div>
        <button id="themeToggle" class="btn btn-outline-secondary btn-sm">
            <i class="bi bi-moon"></i> Dark
        </button>
        <span class="me-3">ðŸ‘¤ Logged in as: <strong>@ViewBag.Username</strong> (@ViewBag.Role)</span>
        <a href="/Account/Logout" class="btn btn-outline-danger btn-sm">
            <i class="bi bi-box-arrow-right"></i> Logout
        </a>
    </div>
</div>

<div class="container-fluid p-4">

    <!-- Filters -->
    <div class="card shadow-sm mb-3">
        <div class="card-body d-flex gap-3 flex-wrap">
            <select class="form-select w-auto" id="websiteFilter">
                <option value="all">All Websites</option>
                <option value="siteA">Website A</option>
                <option value="siteB">Website B</option>
                <option value="siteC">Website C</option>
            </select>

            <select class="form-select w-auto" id="sourceFilter">
                <option value="all">All Sources</option>
                <option value="google">Google</option>
                <option value="bing">Bing</option>
                <option value="direct">Direct</option>
            </select>
        </div>
    </div>

    <!-- Comparison Settings -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <label class="form-label fw-bold">Comparison Settings</label>
            <select class="form-select w-auto" id="comparisonFilter">
                <option value="none">No Comparison</option>
                <option value="prev">Previous Period</option>
                <option value="year">Last Year</option>
            </select>
        </div>
    </div>

    <!-- Tabs -->
    <ul class="nav nav-tabs mb-3" id="dashboardTabs" role="tablist">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#traffic">Traffic Overview</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#analytics">Analytics Detail</button></li>
    </ul>

    <div class="tab-content">
        <!-- Tab 1: Traffic Overview -->
        <div class="tab-pane fade show active" id="traffic">
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card shadow-sm"><div class="card-body"><h6>Traffic Distribution</h6><canvas id="donutChart"></canvas></div></div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body d-flex justify-content-between">
                            <h6>Traffic Trends</h6>
                            <div class="d-flex gap-2">
                                <select class="form-select form-select-sm" id="ipFilter">
                                    <option value="all">All IPs</option>
                                    <option value="local">Local</option>
                                    <option value="other">Other</option>
                                </select>
                                <select class="form-select form-select-sm" id="periodFilter">
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>
                        <canvas id="lineChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="row" id="summaryCards"></div>
        </div>

        <!-- Tab 2: Analytics Detail -->
        <div class="tab-pane fade" id="analytics">
            <div class="row mb-4">
                <div class="col-md-4"><div class="card shadow-sm p-3 text-center"><h6>Total Visitors</h6><h3 id="totalVisitors">0</h3></div></div>
                <div class="col-md-4"><div class="card shadow-sm p-3 text-center"><h6>Total Pageviews</h6><h3 id="totalPageviews">0</h3></div></div>
                <div class="col-md-4"><div class="card shadow-sm p-3 text-center"><h6>Realtime Pageviews</h6><h3 id="realtimePageviews">0</h3></div></div>
            </div>
            <div class="card shadow-sm mb-4"><div class="card-body"><h6>Pageviews Over Time</h6><canvas id="barChart"></canvas></div></div>
            <div class="row">
                <div class="col-md-6"><div class="card shadow-sm"><div class="card-body"><h6>Top Pages</h6><table class="table table-sm"><thead><tr><th>#</th><th>Pages</th><th>Visitors</th><th>Pageviews</th></tr></thead><tbody id="pagesTable"></tbody></table></div></div></div>
                <div class="col-md-6"><div class="card shadow-sm"><div class="card-body"><h6>Top Referrers</h6><table class="table table-sm"><thead><tr><th>#</th><th>Referrer</th><th>Visitors</th><th>Pageviews</th></tr></thead><tbody id="referrersTable"></tbody></table></div></div></div>
            </div>
        </div>
    </div>
</div>

<!-- Script khusus dashboard -->
<script>
    // ... JS loadData() dan dark-mode toggle yang kamu punya tadi ...
</script>
